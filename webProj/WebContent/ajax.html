<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="ajax.html" content="width=device-width, initial-scale=1.0">
<title>ajax.html</title>
</head>
<body>
	
	<form action="empList.do" method="POST">
		LastName : <input type="text" name="last_name" id=""><br>
		Email : <input type="text" name="email" id=""><br>
		HireDate : <input type="text" name="hire_date" id=""><br>
		JobId : <input type="text" name="job_id" id=""><br> 
		<input type="submit" value="저장"> <input type="reset" value="취소">
	</form>
	<div id="show"></div>
	<script>    
        /*
        //동기-비동기 >> 동기는 순차적으로 느적느적 // 비동기는 시간 걸리는건 걸리는대로 나중에 출력
        //직렬-병렬 느낌인거같음
        console.log('1');
        setTimeout(function () {
            console.log('2')        
        }, 1000);
        console.log('3'); 
        */

        var xhtp = new XMLHttpRequest();
        // readyState : 
        // 1 => connection.         2 => request received.
        // 3 => processing request  4 => request finished response ready
        xhtp.onreadystatechange = function () {
            // console.log(xhtp.readyState, xhtp.status, xhtp.responseText);
            if(xhtp.readyState == 4 && xhtp.status == 200) {    // 요청을 보냈을때 답이 4번이고 + 200 = ok >> 404 = not found 같은 코드
                var show = document.getElementById('show');
                var obj = JSON.parse(xhtp.responseText);
                console.log(obj);
                // table tr td => div.appendChild();
                var table = document.createElement('table');
                table.setAttribute('border', '1');
                
                // 배열의 갯수만큼 tr 생성 (obj 개수만큼 반복 >> for of)
                for (var data of obj){
    	            var tr = document.createElement('tr');                
	                // field 수만큼 반복해서 td 생성 (field 개수만큼 반복 >> for in)
	                for(var field in data) {
      		          	var td = document.createElement('td');
            	        var text = document.createTextNode(data[field]);
                    
                	    td.appendChild(text);
                   		tr.appendChild(td);
     	           }                                               
     	           table.appendChild(tr);
                	
                }
                // div#show 의 자식으로 table을 달아준다
                document.getElementById('show').appendChild(table);
            }
        }
        xhtp.open('get', 'empList.do?dept=50'); // = ('get', 'http://localhost/webProj/empList.do?dept=50')
        xhtp.send();
    </script>
</body>
</html>